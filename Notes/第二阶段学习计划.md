# Kubernetes 学习路径 - 第二阶段（筑基期）详细学习计划

## 🎯 阶段目标
- **时间安排**: 4-6 周，每周 8-10 小时（总计 32-60 小时）
- **核心目标**: 
  - 深入理解 Kubernetes 基本架构
  - 掌握 Kubernetes 容器调度的基本流程

## 📅 详细周计划

### 第1周：理论基础和架构概览（8-10小时）

#### Day 1-2: Control Plane & Node 架构理解（3-4小时）
**学习内容**：
- [ ] 阅读官方文档：[Kubernetes Components](https://kubernetes.io/docs/concepts/overview/components/)
- [ ] 理解 Control Plane（原 Master）和 Node 的关系
- [ ] 学习组件间的通信机制

**实践任务**：
- [ ] 使用 `kubectl get nodes -o wide` 查看集群节点信息
- [ ] 使用 `kubectl get pods -n kube-system` 查看系统组件
- [ ] 绘制 Kubernetes 架构图（手绘或工具）

**知识点检查**：
- 能说出 Control Plane 包含哪些组件？
- Node 节点包含哪些核心组件？
- 各组件之间如何通信？

#### Day 3-4: API Server 深入理解（3-4小时）
**学习内容**：
- [ ] API Server 的职责和工作原理
- [ ] RESTful API 设计理念
- [ ] 请求处理流程：认证、授权、准入控制

**实践任务**：
- [ ] 使用 `kubectl proxy` 访问 API Server
- [ ] 通过 curl 直接调用 Kubernetes API
- [ ] 查看 API Server 日志：`kubectl logs -n kube-system <api-server-pod>`

**知识点检查**：
- API Server 如何处理一个 kubectl 请求？
- 什么是 API 版本控制？

#### Day 5-7: Etcd 存储机制（2-3小时）
**学习内容**：
- [ ] 阅读 [Etcd 官方文档](https://etcd.io/docs)
- [ ] 理解分布式一致性算法（Raft）
- [ ] Kubernetes 如何使用 Etcd

**实践任务**：
- [ ] 使用 `kubectl get --raw /api/v1/namespaces` 查看存储的数据
- [ ] 了解 Etcd 备份和恢复（理论）

**知识点检查**：
- Etcd 解决了什么问题？
- Kubernetes 在 Etcd 中存储了什么数据？

---

### 第2周：控制器和调度器深入（8-10小时）

#### Day 1-3: Controller Manager 核心理念（4-5小时）
**学习内容**：
- [ ] 控制器模式（Controller Pattern）
- [ ] List-Watch 机制原理
- [ ] 常见控制器类型：Deployment、ReplicaSet、Service 等

**实践任务**：
- [ ] 创建 Deployment，观察 ReplicaSet 和 Pod 的创建过程
- [ ] 手动删除 Pod，观察控制器如何恢复
- [ ] 使用 `kubectl get events` 观察控制器行为

**知识点检查**：
- 什么是声明式 API？
- List-Watch 如何实现实时同步？
- 控制循环的工作原理？

#### Day 4-5: Scheduler 调度机制（3-4小时）
**学习内容**：
- [ ] 阅读：[Kubernetes Scheduler](https://kubernetes.io/docs/concepts/scheduling/kube-scheduler/)
- [ ] 调度算法：预选（Predicate）和优选（Priority）
- [ ] 资源请求和限制对调度的影响

**实践任务**：
- [ ] 创建有资源需求的 Pod
- [ ] 使用 `kubectl describe pod` 查看调度决策
- [ ] 模拟节点资源不足的情况

**知识点检查**：
- Pod 调度的完整流程是什么？
- 调度器如何处理资源约束？

#### Day 6-7: 深度阅读和理解（1-2小时）
**学习内容**：
- [ ] 阅读：[What happens when I type kubectl run?](https://github.com/jamiehannaford/what-happens-when-k8s)
- [ ] 中文版：[kubectl 创建 Pod 背后到底发生了什么？](https://mp.weixin.qq.com/s/ctdvbasKE-vpLRxDJjwVMw)

---

### 第3周：Node 组件和网络（8-10小时）

#### Day 1-3: Kubelet 深入理解（4-5小时）
**学习内容**：
- [ ] Kubelet 的职责和工作机制
- [ ] Pod 生命周期管理
- [ ] 容器运行时接口（CRI）

**实践任务**：
- [ ] 查看 Kubelet 日志
- [ ] 使用 `kubectl describe node` 查看节点详情
- [ ] 理解 Pod 的创建、运行、销毁过程

**知识点检查**：
- Kubelet 如何与 API Server 通信？
- Pod 在节点上的完整生命周期？

#### Day 4-5: Container Runtime 探索（2-3小时）
**学习内容**：
- [ ] Docker、Containerd、CRI-O 对比
- [ ] 容器镜像管理
- [ ] 容器网络基础

**实践任务**：
- [ ] 使用 `docker ps` 或 `crictl ps` 查看容器
- [ ] 理解镜像拉取过程
- [ ] 观察容器日志和资源使用

#### Day 6-7: Kube-proxy 和网络（2-3小时）
**学习内容**：
- [ ] Service 的实现原理
- [ ] iptables 和 IPVS 模式
- [ ] 网络插件（CNI）基础

**实践任务**：
- [ ] 创建 Service，查看 iptables 规则
- [ ] 理解 ClusterIP、NodePort、LoadBalancer

---

### 第4周：核心插件和实战（8-10小时）

#### Day 1-2: DNS 服务发现（3-4小时）
**学习内容**：
- [ ] CoreDNS 配置和工作原理
- [ ] Kubernetes 中的 DNS 解析
- [ ] Service Discovery 机制

**实践任务**：
- [ ] 测试 Pod 间的 DNS 解析
- [ ] 查看 CoreDNS 配置
- [ ] 创建自定义 DNS 记录

#### Day 3-4: 网络插件理解（3-4小时）
**学习内容**：
- [ ] CNI 插件架构
- [ ] Flannel 工作原理
- [ ] Pod 网络通信机制

**实践任务**：
- [ ] 查看网络插件配置
- [ ] 测试跨节点 Pod 通信
- [ ] 理解网络策略基础

#### Day 5-7: 综合实践（2-3小时）
**实践任务**：
- [ ] 完成 [lab3-manual-installation](../tutorials/lab3-manual-installtion.md)
- [ ] 尝试手动安装 Kubernetes 组件
- [ ] 排查和解决安装过程中的问题

---

### 第5-6周：深化理解和实战（8-16小时）

#### 高级实践项目：
1. **组件交互分析**（4-6小时）
   - [ ] 追踪一个 Pod 从创建到运行的完整流程
   - [ ] 分析各组件的日志和事件
   - [ ] 绘制详细的交互时序图

2. **故障排查练习**（4-6小时）
   - [ ] 模拟组件故障
   - [ ] 练习日志分析和问题定位
   - [ ] 学习常见问题的解决方法

3. **性能监控和优化**（2-4小时）
   - [ ] 使用 `kubectl top` 监控资源使用
   - [ ] 理解资源配额和限制
   - [ ] 学习集群性能调优基础

## 📚 推荐学习资源

### 必读文档
- [ ] [Kubernetes 官方架构文档](https://kubernetes.io/docs/concepts/architecture/)
- [ ] [Kubernetes 指南 - feisky](https://kubernetes.feisky.xyz/concepts/index)
- [ ] [Etcd 官方文档](https://etcd.io/docs)

### 实践工具
- [ ] `kubectl` 命令行工具
- [ ] `minikube` 或 `kind` 本地环境
- [ ] 日志查看和监控工具

### 扩展阅读
- [ ] 《Kubernetes in Action》相关章节
- [ ] 官方 Blog 中的架构文章
- [ ] CNCF 相关技术分享

## ✅ 阶段检查清单

### 理论理解检查
- [ ] 能画出 Kubernetes 完整架构图
- [ ] 能解释 Pod 创建的完整流程
- [ ] 理解控制器模式和声明式 API
- [ ] 掌握调度器的工作原理
- [ ] 了解网络和存储的基本原理

### 实践技能检查
- [ ] 能够查看和分析各组件日志
- [ ] 能够使用 kubectl 进行集群诊断
- [ ] 能够解释集群中发生的事件
- [ ] 具备基本的故障排查能力

### 核心问题回答
在完成本阶段学习后，你应该能够回答：
1. **Kubernetes 组件是如何交互，来启动容器，并对外提供服务的？**
2. **当我执行 `kubectl apply -f deployment.yaml` 时，集群内部发生了什么？**
3. **Pod 调度和启动的完整流程是什么？**
4. **如何诊断和解决常见的集群问题？**

## 💡 学习建议

### 学习方法
1. **理论与实践结合**：每学完一个概念，立即通过实验验证
2. **绘图记忆**：通过画图加深对架构的理解
3. **日志分析**：养成查看日志的习惯
4. **问题驱动**：带着问题去学习，寻找答案

### 时间分配建议
- **理论学习**: 40%（阅读文档、博客）
- **实践操作**: 45%（命令行实验、环境搭建）
- **总结整理**: 15%（笔记、思维导图）

### 遇到困难时
1. 查看官方文档和日志
2. 搜索相关问题和解决方案
3. 在社区论坛提问
4. 与其他学习者交流讨论

记住：**筑基期是比较困难的阶段，请不要气馁！理解架构原理是后续学习的重要基础。** 💪